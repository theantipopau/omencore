<UserControl x:Class="OmenCore.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:OmenCore.Controls"
             xmlns:utils="clr-namespace:OmenCore.Utils"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1000">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Styles/ModernStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,12">
            <TextBlock Text="Settings" 
                       FontSize="28" FontWeight="Bold" 
                       Foreground="{StaticResource TextPrimaryBrush}"/>
            <TextBlock Text="Configure application behavior, startup options, and driver settings" 
                       FontSize="12" 
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Opacity="0.9"
                       Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Sub-tabs for easier navigation (GitHub #48 - kg290) -->
        <TabControl Grid.Row="1" Style="{StaticResource ModernTabControl}" ItemContainerStyle="{StaticResource ModernTabItem}" Margin="0,8,0,0">
            <!-- Status Tab -->
            <TabItem Header="Status">
                <ScrollViewer Style="{StaticResource SmoothScrollViewer}" 
                              IsDeferredScrollingEnabled="True"
                              Padding="0,0,12,0">
                    <StackPanel>
                        <!-- System Status Section -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconMonitoring}" 
                                  Fill="#4CAF50" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="System Status" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Backend Status -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan Control Backend" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="The method used to control fans on your system" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <Border Grid.Column="1" Background="#1A4CAF50" CornerRadius="4" Padding="12,6">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#4CAF50" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding FanBackend, FallbackValue=Detecting...}" 
                                               FontSize="13" FontWeight="SemiBold"
                                               Foreground="#4CAF50"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                        
                        <!-- Secure Boot Status -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Secure Boot" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Secure Boot is disabled - legacy drivers available"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                    <Setter Property="Text" Value="Secure Boot blocks unsigned drivers. Use PawnIO or WMI BIOS."/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1A4CAF50"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                <Setter Property="Background" Value="#1AFF9800"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Disabled"/>
                                            <Setter Property="Foreground" Value="#4CAF50"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                    <Setter Property="Text" Value="ðŸ”’ Enabled"/>
                                                    <Setter Property="Foreground" Value="#FF9800"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                        
                        <!-- PawnIO Status -->
                        <Grid Margin="0,0,0,12" Visibility="{Binding SecureBootEnabled, Converter={StaticResource BoolToVisibility}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="PawnIO Driver" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Secure Boot compatible driver for EC/MSR access" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1AF44336"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding PawnIOAvailable}" Value="True">
                                                <Setter Property="Background" Value="#1A4CAF50"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Not Installed"/>
                                            <Setter Property="Foreground" Value="#F44336"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding PawnIOAvailable}" Value="True">
                                                    <Setter Property="Text" Value="âœ“ Installed"/>
                                                    <Setter Property="Foreground" Value="#4CAF50"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                        
                        <!-- OGH Status -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="OMEN Gaming Hub" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="HP's official control software - provides WMI access" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                                <!-- Show detection detail when OGH is detected -->
                                <TextBlock Text="{Binding OghDetectionDetail}" 
                                           FontSize="10" 
                                           Foreground="#FF9800"
                                           FontFamily="Consolas"
                                           Margin="0,4,0,0"
                                           TextWrapping="Wrap"
                                           Visibility="{Binding OghInstalled, Converter={StaticResource BoolToVisibility}}"/>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1A808080"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding OghInstalled}" Value="True">
                                                <Setter Property="Background" Value="#1AFF9800"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Not Detected"/>
                                            <Setter Property="Foreground" Value="#808080"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding OghInstalled}" Value="True">
                                                    <Setter Property="Text" Value="âš  Running"/>
                                                    <Setter Property="Foreground" Value="#FF9800"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                        
                        <!-- Standalone Status (v2.7.0) -->
                        <Border Margin="0,16,0,0" Padding="16" CornerRadius="8" BorderThickness="1">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Background" Value="#1A00FF88"/>
                                    <Setter Property="BorderBrush" Value="#4000FF88"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding StandaloneStatus}" Value="Degraded">
                                            <Setter Property="Background" Value="#1AFFD93D"/>
                                            <Setter Property="BorderBrush" Value="#40FFD93D"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding StandaloneStatus}" Value="Limited">
                                            <Setter Property="Background" Value="#1AFF6B6B"/>
                                            <Setter Property="BorderBrush" Value="#40FF6B6B"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,16,0">
                                    <TextBlock Text="ðŸ”" FontSize="24"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Standalone Status" FontSize="14" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <TextBlock Text="{Binding StandaloneStatusSummary, FallbackValue=Checking dependencies...}" 
                                               FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" 
                                               TextWrapping="Wrap" Margin="0,2,0,0"/>
                                </StackPanel>
                                <Border Grid.Column="2" CornerRadius="4" Padding="12,6" VerticalAlignment="Center">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#2000FF88"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding StandaloneStatus}" Value="Degraded">
                                                    <Setter Property="Background" Value="#20FFD93D"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding StandaloneStatus}" Value="Limited">
                                                    <Setter Property="Background" Value="#20FF6B6B"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="{Binding StandaloneStatus, FallbackValue=Checking...}" 
                                               FontSize="13" FontWeight="Bold">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="#00FF88"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding StandaloneStatus}" Value="Degraded">
                                                        <Setter Property="Foreground" Value="#FFD93D"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding StandaloneStatus}" Value="Limited">
                                                        <Setter Property="Foreground" Value="#FF6B6B"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
            </TabItem>
            
            <!-- General Tab -->
            <TabItem Header="General">
                <ScrollViewer Style="{StaticResource SmoothScrollViewer}" 
                              IsDeferredScrollingEnabled="True"
                              Padding="0,0,12,0">
                    <StackPanel Margin="20,20,20,40">
                
                <!-- General Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconSettings}" 
                                  Fill="{StaticResource AccentBrush}" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="General" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Start with Windows -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Start with Windows" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Launch OmenCore automatically when Windows starts" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding StartWithWindows}"/>
                        </Grid>

                        <!-- Start Minimized -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Start minimized to tray" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Hide main window on startup, show only in system tray" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding StartMinimized}"/>
                        </Grid>

                        <!-- Minimize to Tray on Close -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Minimize to tray on close" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Close button minimizes to system tray instead of exiting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding MinimizeToTrayOnClose}"/>
                        </Grid>

                        <!-- Show Temperature on Tray Icon -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Show temperature on tray icon" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Display live CPU/GPU temperature on the system tray icon" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding TrayTempDisplayEnabled}"/>
                        </Grid>

                        <!-- Corsair HID-only mode (Disable iCUE fallback) -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Corsair: Disable iCUE fallback (HID-only mode)" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Use direct HID access for Corsair devices. May not work for all devices; restart required." FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding CorsairDisableIcueFallback, Mode=TwoWay}"/>
                        </Grid>

                        <TextBlock Text="Warning: HID-only mode may reduce compatibility with some Corsair devices. If lighting control stops working, re-enable iCUE fallback or install iCUE." 
                                   FontSize="12" Foreground="#FFB74D" Margin="0,4,0,0" TextWrapping="Wrap"
                                   Visibility="{Binding CorsairDisableIcueFallback, Converter={StaticResource BoolToVisibility}}"/>

                        <!-- Telemetry opt-in -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable anonymous lighting telemetry" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Share anonymous, aggregated counts of Corsair PID success/failure to help us improve device coverage. No device-identifying data is collected." FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding TelemetryEnabled, Mode=TwoWay}" 
                                          ToolTipService.ToolTip="Share anonymous PID success/failure counts to help improve device support. Opt-in only; stored at %LOCALAPPDATA%\OmenCore\telemetry.json"/>
                        </Grid>
                    </StackPanel>
                </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Advanced">
                <ScrollViewer Style="{StaticResource SmoothScrollViewer}" Padding="0,0,12,0">
                    <StackPanel Margin="20,20,20,40">

                <!-- Monitoring Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconMonitoring}" 
                                  Fill="#4FC3F7" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Monitoring" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Polling Interval -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Polling interval" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="How often to read hardware sensors" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Slider Minimum="500" Maximum="5000" 
                                        TickFrequency="250"
                                        IsSnapToTickEnabled="True"
                                        Value="{Binding PollingIntervalMs}"
                                        Width="120" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding PollingIntervalMs, StringFormat={}{0} ms}" 
                                           FontSize="12" Width="60" TextAlignment="Right"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- History Length -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Chart history" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Number of data points to display in charts" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Slider Minimum="30" Maximum="300" 
                                        TickFrequency="30"
                                        IsSnapToTickEnabled="True"
                                        Value="{Binding HistoryCount}"
                                        Width="120" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding HistoryCount, StringFormat={}{0} points}" 
                                           FontSize="12" Width="60" TextAlignment="Right"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Low Overhead Mode -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Low overhead mode" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Reduce CPU usage by limiting sensor polling" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding LowOverheadMode}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Power Automation Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M12 3C10.3 3 9 4.3 9 6V8H15V6C15 4.3 13.7 3 12 3M7 8V6C7 3.2 9.2 1 12 1S17 3.2 17 6V8H18C19.1 8 20 8.9 20 10V20C20 21.1 19.1 22 18 22H6C4.9 22 4 21.1 4 20V10C4 8.9 4.9 8 6 8H7M13 15V17H11V15H9V13H11V11H13V13H15V15H13Z" 
                                  Fill="#FFB74D" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Power Automation" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Power Automation -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Auto-switch on power change" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Automatically switch profiles when AC power is connected or disconnected" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding PowerAutomationEnabled, Mode=TwoWay}"/>
                        </Grid>

                        <!-- AC Power Settings -->
                        <TextBlock Text="When on AC Power:" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan preset" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding AcFanPreset, Mode=TwoWay}"
                                      ItemsSource="{Binding FanPresetOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Performance mode" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding AcPerformanceMode, Mode=TwoWay}"
                                      ItemsSource="{Binding PerformanceModeOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>

                        <!-- Battery Settings -->
                        <TextBlock Text="When on Battery:" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,8,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan preset" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding BatteryFanPreset, Mode=TwoWay}"
                                      ItemsSource="{Binding FanPresetOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Performance mode" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding BatteryPerformanceMode, Mode=TwoWay}"
                                      ItemsSource="{Binding PerformanceModeOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>

                        <!-- Current Power Status -->
                        <Border Background="#1F1F1F" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Current status: " FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding CurrentPowerStatus}" FontSize="12" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Updates Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconUpdate}" 
                                  Fill="#81C784" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Updates" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Auto Check Updates -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Check for updates automatically" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Periodically check GitHub for new releases" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding AutoCheckUpdates}"/>
                        </Grid>

                        <!-- Update Check Interval -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Check interval" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="How often to check for updates" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource ModernComboBox}"
                                      SelectedIndex="{Binding UpdateCheckIntervalIndex}"
                                      HorizontalAlignment="Right" Width="150">
                                <ComboBoxItem Content="Every hour"/>
                                <ComboBoxItem Content="Every 6 hours"/>
                                <ComboBoxItem Content="Daily"/>
                                <ComboBoxItem Content="Weekly"/>
                            </ComboBox>
                        </Grid>

                        <!-- Include Pre-releases -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Include pre-releases" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Get notified about beta and preview versions" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding IncludePreReleases}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Hotkeys Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="âŒ¨ï¸" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Hotkeys" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Hotkeys -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable global hotkeys" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Use keyboard shortcuts even when app is in background" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding HotkeysEnabled}"/>
                        </Grid>

                        <!-- Hotkey Reference -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="16" Margin="0,8,0,0">
                            <StackPanel>
                                <TextBlock Text="Default Hotkeys" FontSize="14" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ctrl + Shift + F" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Cycle fan modes" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ctrl + Shift + P" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="Cycle performance modes" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ctrl + Shift + B" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="Boost mode (Performance)" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Ctrl + Shift + Q" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="Quiet mode" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Ctrl + Shift + O" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="Show/hide OmenCore window" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Notifications Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ””" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Notifications" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Show Windows toast notifications for events" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Game Profile Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Game profile notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Notify when game profiles are activated/deactivated" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GameNotificationsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Mode Change Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Mode change notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Notify when fan or performance modes change via hotkey" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding ModeChangeNotificationsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Temperature Warning Notifications -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Temperature warnings" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Alert when CPU/GPU temperature exceeds threshold" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding TemperatureWarningsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Driver Installation -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconSettings}" 
                                  Fill="#9575CD" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Hardware Driver" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Driver Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Ellipse Grid.Column="0" 
                                         Width="12" Height="12" 
                                         Fill="{Binding DriverStatusColor}"
                                         VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding DriverStatusText}" 
                                               FontSize="14" FontWeight="SemiBold"
                                               Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <TextBlock Text="{Binding DriverStatusDetail}" 
                                               FontSize="12" 
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <TextBlock TextWrapping="Wrap" FontSize="13" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            On modern Windows systems, Secure Boot and Memory Integrity can block legacy drivers.
                            OmenCore prefers driverless control paths (WMI/OGH) when available, and recommends PawnIO for Secure Boot compatible MSR/EC access.
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ“¥ Get PawnIO (Recommended)" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#9575CD"
                                    Command="{Binding InstallDriverCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"
                                    Margin="0,0,12,0"/>
                            <Button Content="ðŸ”„ Refresh Status" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding RefreshDriverStatusCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"/>
                        </StackPanel>
                        
                        <!-- EC Reset Section -->
                        <Border Background="#1AFF6B6B" CornerRadius="8" Padding="12" Margin="0,16,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Reset EC to Defaults" FontSize="13" FontWeight="SemiBold"
                                               Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <TextBlock FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap">
                                        <Run Text="Restores BIOS fan control. Use if BIOS shows stuck/incorrect fan values."/>
                                    </TextBlock>
                                </StackPanel>
                                <Button Grid.Column="1" 
                                        Content="ðŸ”§ Reset EC"
                                        Style="{StaticResource ModernButton}"
                                        Background="#E57373"
                                        Command="{Binding ResetEcToDefaultsCommand}"
                                        VerticalAlignment="Center"
                                        Padding="16,8"/>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- BIOS Update Check -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M9,2V7H12V10H9A3,3 0 0,0 6,13V15A3,3 0 0,0 9,18H12V22H14V18H15A3,3 0 0,0 18,15V13A3,3 0 0,0 15,10H14V7H17V2H15V5H12V2H9M9,12H15A1,1 0 0,1 16,13V15A1,1 0 0,1 15,16H9A1,1 0 0,1 8,15V13A1,1 0 0,1 9,12Z" 
                                  Fill="#4DD0E1" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="BIOS Information" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- System Model -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="HP Model:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding SystemModel}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </Grid>

                        <!-- Current BIOS -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Current BIOS:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding CurrentBiosVersion}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </Grid>

                        <!-- Latest BIOS (only show when we have a version) -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Latest BIOS:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <TextBlock Grid.Column="1" Text="{Binding LatestBiosVersion}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </Grid>

                        <!-- BIOS Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,8,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Ellipse Grid.Column="0" 
                                         Width="12" Height="12" 
                                         Fill="{Binding BiosStatusColor}"
                                         VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" Text="{Binding BiosCheckStatus}" 
                                           FontSize="13" 
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <TextBlock TextWrapping="Wrap" FontSize="12" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            Check HP's website for BIOS updates. Always read the release notes before updating BIOS.
                            BIOS updates can improve stability, security, and compatibility.
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ” Check for Updates" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#4DD0E1"
                                    Command="{Binding CheckBiosUpdatesCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"
                                    Margin="0,0,12,0"/>
                            <Button Content="â¬‡ï¸ Download Update" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#66BB6A"
                                    Command="{Binding DownloadBiosUpdateCommand}"
                                    Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Fan Boost / Maintenance -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconFan}" 
                                  Fill="#FFB74D" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Fan Boost" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <TextBlock TextWrapping="Wrap" FontSize="13" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            Runs fans at maximum speed to increase airflow and help dislodge loose dust particles.
                        </TextBlock>
                        
                        <!-- Important disclaimer -->
                        <Border Background="#33FFB74D" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextPrimaryBrush}">
                                <Run Foreground="#FFB74D" FontWeight="Bold">âš ï¸ Note:</Run>
                                This is NOT the same as HP's "Fan Cleaner" feature (OMEN Max only) which actually reverses fan direction.
                                That requires special omnidirectional fans that most OMEN laptops don't have.
                                <LineBreak/><LineBreak/>
                                For thorough cleaning, use compressed air or open the chassis.
                            </TextBlock>
                        </Border>

                        <!-- HP OMEN Detection Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Grid.Column="0" 
                                      Data="{Binding FanCleaningStatusIcon}" 
                                      Fill="{Binding FanCleaningStatusColor}" 
                                      Width="20" Height="20" Stretch="Uniform" 
                                      VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                           Text="{Binding FanCleaningStatusText}" 
                                           FontSize="13" 
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <Button Content="ðŸ’¨ Start Fan Boost" 
                                Style="{StaticResource ModernButton}"
                                Background="#FFB74D"
                                Command="{Binding StartFanCleaningCommand}"
                                IsEnabled="{Binding CanStartFanCleaning}"
                                HorizontalAlignment="Left"
                                Padding="20,10"/>

                        <!-- Boost Progress -->
                        <StackPanel Visibility="{Binding IsFanCleaningActive, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    Margin="0,16,0,0">
                            <TextBlock Text="{Binding FanCleaningProgress}" 
                                       FontSize="14" 
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,8"/>
                            <ProgressBar Value="{Binding FanCleaningProgressPercent}" 
                                         Maximum="100" Height="8"
                                         Foreground="#FFB74D"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- HP Bloatware Removal -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z" 
                                  Fill="#EF5350" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="HP Bloatware Removal" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Remove unnecessary HP pre-installed apps" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <TextBlock TextWrapping="Wrap" FontSize="13" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            Scan for and remove HP bloatware apps that may slow down your system. HP Support Assistant is excluded and will be preserved.
                        </TextBlock>
                        
                        <!-- Warning disclaimer -->
                        <Border Background="#33EF5350" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextPrimaryBrush}">
                                <Run Foreground="#EF5350" FontWeight="Bold">âš ï¸ Warning:</Run>
                                This action cannot be undone! Apps can only be reinstalled from the Microsoft Store or HP Support.
                                <LineBreak/><LineBreak/>
                                A system restart is recommended after removal to ensure all components are fully unloaded.
                            </TextBlock>
                        </Border>

                        <!-- Scan Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,0,0,16"
                                Visibility="{Binding BloatwareList, Converter={StaticResource StringNotEmptyToVisibilityConverter}}">
                            <StackPanel>
                                <TextBlock FontSize="13" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           Margin="0,0,0,8">
                                    <Run Text="Found "/>
                                    <Run Text="{Binding BloatwareCount, Mode=OneWay}" Foreground="#EF5350" FontWeight="Bold"/>
                                    <Run Text=" HP bloatware packages:"/>
                                </TextBlock>
                                <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding BloatwareList}" 
                                               FontSize="12" FontFamily="Consolas"
                                               Foreground="{StaticResource TextSecondaryBrush}"
                                               TextWrapping="Wrap"/>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ” Scan for Bloatware" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#42A5F5"
                                    Command="{Binding ScanBloatwareCommand}"
                                    IsEnabled="{Binding IsScanningBloatware, Converter={StaticResource InverseBooleanConverter}}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"
                                    Margin="0,0,12,0"/>
                            <Button Content="ðŸ—‘ï¸ Remove Bloatware" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#EF5350"
                                    Command="{Binding RemoveBloatwareCommand}"
                                    Visibility="{Binding BloatwareCount, Converter={StaticResource IntGreaterThanZeroToVisibilityConverter}}"
                                    IsEnabled="{Binding IsScanningBloatware, Converter={StaticResource InverseBooleanConverter}}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"/>
                        </StackPanel>

                        <!-- Scanning Progress -->
                        <StackPanel Visibility="{Binding IsScanningBloatware, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    Margin="0,16,0,0">
                            <TextBlock Text="{Binding BloatwareProgress}" 
                                       FontSize="14" FontWeight="SemiBold"
                                       Foreground="#42A5F5"
                                       Margin="0,0,0,8"/>
                            <ProgressBar IsIndeterminate="True" Height="8"
                                         Foreground="#42A5F5"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Feature Toggles -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ§©" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Feature Modules" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Enable/disable features to reduce resource usage" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Corsair Integration -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Corsair iCUE Integration" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Support for Corsair keyboards, mice, headsets" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding CorsairIntegrationEnabled}"/>
                        </Grid>

                        <!-- Logitech Integration -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Logitech G HUB Integration" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Support for Logitech G peripherals" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding LogitechIntegrationEnabled}"/>
                        </Grid>

                        <!-- Game Profiles -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Game Profile Auto-Switching" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Automatically apply profiles when games launch" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GameProfilesEnabled}"/>
                        </Grid>

                        <!-- Keyboard Lighting -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Keyboard Backlight Control" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="OMEN keyboard 4-zone RGB lighting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding KeyboardLightingEnabled}"/>
                        </Grid>
                        
                        <!-- Ambient Lighting (Screen Color Sampling) -->
                        <Border Background="#1A4285F4" CornerRadius="8" Padding="16" Margin="0,0,0,12">
                            <StackPanel>
                                <Grid Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="ðŸŒˆ Ambient Lighting" FontSize="14" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock Text="Sync keyboard/peripherals with screen colors (Ambilight-style)" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding AmbientLightingEnabled}"/>
                                </Grid>
                                
                                <!-- Saturation Slider -->
                                <StackPanel Margin="0,8,0,0" Visibility="{Binding AmbientLightingEnabled, Converter={StaticResource BooleanToVisibilityConverter}}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Saturation:" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <Slider Grid.Column="1" 
                                                Value="{Binding AmbientLightingSaturation, Mode=TwoWay}"
                                                Minimum="0.5" Maximum="2.0" 
                                                TickFrequency="0.1" IsSnapToTickEnabled="True"
                                                VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" 
                                                   Text="{Binding AmbientLightingSaturation, StringFormat={}{0:F1}x}" 
                                                   FontSize="12" Foreground="{StaticResource AccentBrush}"
                                                   VerticalAlignment="Center" Margin="8,0,0,0" MinWidth="35"/>
                                    </Grid>
                                    
                                    <!-- FPS Slider -->
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Update Rate:" 
                                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <Slider Grid.Column="1" 
                                                Value="{Binding AmbientLightingFps, Mode=TwoWay}"
                                                Minimum="10" Maximum="60" 
                                                TickFrequency="5" IsSnapToTickEnabled="True"
                                                VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" 
                                                   Text="{Binding AmbientLightingFps, StringFormat={}{0} FPS}" 
                                                   FontSize="12" Foreground="{StaticResource AccentBrush}"
                                                   VerticalAlignment="Center" Margin="8,0,0,0" MinWidth="50"/>
                                    </Grid>
                                    
                                    <TextBlock Text="ðŸ’¡ Samples colors from screen edges and applies to RGB devices" 
                                               FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"
                                               Margin="0,8,0,0" FontStyle="Italic"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Experimental EC Keyboard - WARNING SECTION (Always visible to help users) -->
                        <Border Background="#1AFF6B00" CornerRadius="8" Padding="16" Margin="0,8,0,12">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="âš ï¸" FontSize="18" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="EXPERIMENTAL: Direct EC Keyboard Control" 
                                               FontSize="13" FontWeight="SemiBold"
                                               Foreground="#FF9800" VerticalAlignment="Center"/>
                                </StackPanel>
                                
                                <TextBlock Text="Enable only if WMI keyboard control doesn't work on your model." 
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           Margin="0,0,0,8"/>
                                           
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Force EC Keyboard Writes" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock FontSize="11" Foreground="#FFB74D" TextWrapping="Wrap">
                                            <Run Text="âš ï¸ WARNING: EC writes caused crashes on OMEN 17-ck2xxx."/><LineBreak/>
                                            <Run Text="This may hard-crash your system requiring forced restart."/>
                                        </TextBlock>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding ExperimentalEcKeyboardEnabled}"
                                                  VerticalAlignment="Center"/>
                                </Grid>
                                
                                <!-- Exclusive EC Diagnostics -->
                                <Grid Margin="0,12,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Exclusive EC Diagnostics" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock FontSize="11" Foreground="#FFB74D" TextWrapping="Wrap">
                                            <Run Text="âš ï¸ Diagnostic mode: Acquires exclusive EC access to detect conflicts."/><LineBreak/>
                                            <Run Text="May interfere with OMEN Gaming Hub or other fan control apps."/>
                                        </TextBlock>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding ExclusiveEcAccessDiagnosticsEnabled}"
                                                  VerticalAlignment="Center"/>
                                </Grid>
                                
                                <!-- Keyboard Backend Selector -->
                                <Grid Margin="0,12,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Keyboard Backend" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap">
                                            <Run Text="Auto = WMI BIOS â†’ WMI â†’ EC. Set specific if auto-detection fails."/>
                                        </TextBlock>
                                    </StackPanel>
                                    <ComboBox Grid.Column="1" 
                                              Width="110"
                                              VerticalAlignment="Center"
                                              ItemsSource="{Binding KeyboardBackendOptions}"
                                              SelectedItem="{Binding PreferredKeyboardBackend}"/>
                                </Grid>
                                
                                <!-- Zone Order Inversion (OMEN Max 16 Light Bar) -->
                                <Grid Margin="0,12,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Invert RGB Zone Order" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <TextBlock FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap">
                                            <Run Text="Enable for OMEN Max 16 light bar (zones run right-to-left)"/>
                                        </TextBlock>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding InvertRgbZoneOrder}"
                                                  VerticalAlignment="Center"/>
                                </Grid>
                                
                                <TextBlock Text="ðŸ’¡ Safe alternative: Use HP Omen Gaming Hub for keyboard lighting" 
                                           FontSize="11" Foreground="{StaticResource TextSecondaryBrush}"
                                           Margin="0,8,0,0" FontStyle="Italic"/>
                            </StackPanel>
                        </Border>

                        <!-- Fan Curves -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Custom Fan Curves" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Continuous fan speed adjustment (disable for BIOS-only control)" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FanCurvesEnabled}"/>
                        </Grid>

                        <!-- Power Automation -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Power Source Automation" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Auto-switch profiles when plugging/unplugging AC" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FeaturePowerAutomationEnabled}"/>
                        </Grid>

                        <!-- GPU Switching -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="GPU Mode Switching" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Control Hybrid/Discrete/Optimus modes" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GpuSwitchingEnabled}"/>
                        </Grid>

                        <!-- Undervolt -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="CPU Undervolt Controls" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Voltage offset adjustment (requires compatible CPU)" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding UndervoltEnabled}"/>
                        </Grid>

                        <!-- OMEN Key Section -->
                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" Margin="0,8,0,0">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸŽ®" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="OMEN Key Interception" FontSize="14" FontWeight="SemiBold"
                                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                                        </StackPanel>
                                        <TextBlock Text="Capture OMEN key to show OmenCore instead of HP Gaming Hub" FontSize="12" 
                                                   Foreground="{StaticResource TextSecondaryBrush}" Margin="24,4,0,0"/>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding OmenKeyInterceptionEnabled}"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,0" IsEnabled="{Binding OmenKeyInterceptionEnabled}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="OMEN Key Action" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <ComboBox Grid.Column="1" 
                                              SelectedItem="{Binding OmenKeyAction, Mode=TwoWay}"
                                              ItemsSource="{Binding OmenKeyActionOptions}"
                                              IsEnabled="{Binding OmenKeyInterceptionEnabled}"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Note -->
                        <Border Background="#1F1F1F" CornerRadius="4" Padding="12" Margin="0,16,0,0">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}">
                                <Run FontWeight="SemiBold" Foreground="{StaticResource TextPrimaryBrush}">ðŸ’¡ Tip:</Run>
                                Disable unused features to reduce CPU/memory usage. Restart OmenCore for changes to take effect.
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Appearance">
                <ScrollViewer Style="{StaticResource SmoothScrollViewer}" Padding="0,0,12,0">
                    <StackPanel Margin="20,20,20,40">

                <!-- In-Game OSD Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ“Š" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="In-Game OSD" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="On-screen overlay showing system stats during gaming" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Master Enable -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable OSD Overlay" FontSize="14" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="When disabled, no OSD background process runs at all" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding OsdEnabled}"/>
                        </Grid>

                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" 
                                IsEnabled="{Binding OsdEnabled}">
                            <StackPanel>
                                <!-- Position -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Position" FontSize="13" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" 
                                              SelectedItem="{Binding OsdPosition, Mode=TwoWay}"
                                              ItemsSource="{Binding OsdPositionOptions}"/>
                                </Grid>

                                <!-- Hotkey -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Toggle Hotkey" FontSize="13" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding OsdHotkey, Mode=TwoWay}" 
                                             Padding="8,6"/>
                                </Grid>

                                <!-- Metrics Selection -->
                                <TextBlock Text="Metrics to Display" FontSize="13" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,4,0,8"/>
                                
                                <!-- Temperature & Load -->
                                <TextBlock Text="Temperature &amp; Load" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,0,0,4"/>
                                <WrapPanel Margin="0,0,0,8">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="CPU Temp" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowCpuTemp}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="GPU Temp" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowGpuTemp}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="CPU Load %" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowCpuLoad}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="GPU Load %" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowGpuLoad}"/>
                                    </StackPanel>
                                </WrapPanel>
                                
                                <!-- Power & Memory -->
                                <TextBlock Text="Power &amp; Memory" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,4,0,4"/>
                                <WrapPanel Margin="0,0,0,8">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="CPU Power (W)" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowCpuPower}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="GPU Power (W)" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowGpuPower}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="RAM Usage" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowRamUsage}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="VRAM Usage" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowVramUsage}"/>
                                    </StackPanel>
                                </WrapPanel>
                                
                                <!-- Performance -->
                                <TextBlock Text="Performance" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,4,0,4"/>
                                <WrapPanel Margin="0,0,0,8">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Est. FPS" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowFps}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Frametime (ms)" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowFrametime}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Network Ping" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowNetworkLatency}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Net Upload" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowNetworkUpload}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Net Download" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowNetworkDownload}"/>
                                    </StackPanel>
                                </WrapPanel>
                                
                                <!-- System Status -->
                                <TextBlock Text="System Status" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,4,0,4"/>
                                <WrapPanel Margin="0,0,0,4">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Fan Speed (RPM)" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowFanSpeed}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Fan Mode" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowFanMode}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Perf. Mode" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowPerformanceMode}"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,16,4">
                                        <TextBlock Text="Clock Time" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                        <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding OsdShowTime}"/>
                                    </StackPanel>
                                </WrapPanel>
                                
                                <!-- Layout -->
                                <TextBlock Text="Layout" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,8,0,4"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                    <TextBlock Text="Horizontal Layout" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <ToggleButton Style="{StaticResource ModernToggleButton}" IsChecked="{Binding IsOsdHorizontalLayout}"/>
                                    <TextBlock Text="(Compact bar at screen edge)" VerticalAlignment="Center" Margin="8,0,0,0" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Battery Care Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ”‹" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Battery Care" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Extend battery lifespan with smart charge limiting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Enable/Disable Charge Limit -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable Charge Limit" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Stop charging at a custom threshold to preserve battery health" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding BatteryChargeLimitEnabled}"/>
                        </Grid>

                        <!-- Charge Threshold Slider (shown when enabled) -->
                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" Margin="0,0,0,12"
                                Visibility="{Binding BatteryChargeLimitEnabled, Converter={StaticResource BoolToVisibility}}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="140"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Charge Threshold" FontSize="14" FontWeight="SemiBold"
                                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,4"/>
                                    <TextBlock Text="Set maximum battery charge level" FontSize="12" 
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Slider Minimum="60" Maximum="100" 
                                            TickFrequency="5"
                                            IsSnapToTickEnabled="True"
                                            Value="{Binding BatteryChargeThresholdPercent}"
                                            Width="80" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding BatteryChargeThresholdPercent, StringFormat={}{0}%}" 
                                               FontSize="16" FontWeight="Bold" Width="50" TextAlignment="Right"
                                               Foreground="#81C784"
                                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Info Banner -->
                        <Border Background="#1A4CAF50" CornerRadius="4" Padding="12" Margin="0,0,0,0">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}">
                                <Run FontWeight="SemiBold" Foreground="#81C784">ðŸ’¡ Battery Health Tips:</Run>
                                <LineBreak/>
                                â€¢ <Run FontWeight="SemiBold">80%</Run> is recommended for daily use (doubles battery lifespan)
                                <LineBreak/>
                                â€¢ <Run FontWeight="SemiBold">60-70%</Run> for maximum longevity if always plugged in
                                <LineBreak/>
                                â€¢ <Run FontWeight="SemiBold">100%</Run> when you need full capacity for travel
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Fan Hysteresis Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸŒ€" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Fan Hysteresis" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Prevent fan speed oscillation with dead-zone and delays" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Enable -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable Hysteresis" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Smooth out fan speed changes to reduce noise fluctuation" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FanHysteresisEnabled}"/>
                        </Grid>

                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" 
                                IsEnabled="{Binding FanHysteresisEnabled}">
                            <StackPanel>
                                <!-- Dead Zone -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Temperature Dead-Zone" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Fans won't change unless temp moves beyond this" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisDeadZone, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="Â°C" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Ramp Up Delay -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Ramp-Up Delay" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Wait before increasing fan speed" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisRampUpDelay, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="s" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Ramp Down Delay -->
                                <Grid Margin="0,0,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Ramp-Down Delay" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Wait before decreasing fan speed" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisRampDownDelay, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="s" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- Thermal Protection Threshold -->
                                <Grid Margin="0,12,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Thermal Protection Threshold" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Fans ramp up when temps exceed this (70-90Â°C)" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding ThermalProtectionThreshold, StringFormat=F0}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="Â°C" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- HP Omen Gaming Hub Cleanup (only show when OGH is installed) -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16"
                        Visibility="{Binding OghInstalled, Converter={StaticResource BoolToVisibility}}">
                    <StackPanel DataContext="{Binding DataContext.SystemControl, RelativeSource={RelativeSource AncestorType=Window}}">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" 
                                  Fill="OrangeRed" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="HP OMEN Gaming Hub Cleanup" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>
                        
                        <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,0,8" TextWrapping="Wrap">
                            <Run Text="Remove HP OMEN Gaming Hub and related services. This is optional - OmenCore works without OGH installed."/>
                        </TextBlock>
                        
                        <TextBlock FontSize="12" Margin="0,0,0,16" TextWrapping="Wrap">
                            <Run Text="â„¹ï¸ A System Restore point will be created automatically before cleanup begins." FontWeight="Bold" Foreground="#4CAF50"/>
                        </TextBlock>

                        <!-- Cleanup Options -->
                        <StackPanel Margin="0,0,0,16">
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Kill running HP OMEN processes" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupKillProcesses}" HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Uninstall HP OMEN Gaming Hub application" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupUninstallApp}" HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Remove HP OMEN services (OmenService, LightingService)" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupRemoveServices}" HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Clean HP OMEN registry entries" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupRegistryEntries}" HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Remove HP OMEN legacy installers (winget/AppX)" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupRemoveLegacyInstallers}" HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <Grid Margin="0,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="Remove residual HP OMEN files and folders" 
                                           VerticalAlignment="Center" Foreground="{StaticResource TextPrimaryBrush}"/>
                                <ToggleButton Grid.Column="1" Style="{StaticResource ModernToggleButton}" 
                                              IsChecked="{Binding CleanupRemoveFiles}" HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>

                        <!-- System Restore Info -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="16" Margin="0,0,0,16"
                                BorderBrush="#4CAF50" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="âœ“ Automatic System Restore Point" 
                                           FontSize="14" FontWeight="SemiBold"
                                           Foreground="#4CAF50" Margin="0,0,0,8"/>
                                
                                <TextBlock FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap" Margin="0,0,0,8">
                                    <Run Text="A System Restore point will be created automatically before cleanup starts. If restore point creation fails (e.g., System Restore is disabled), you'll be prompted to continue or cancel."/>
                                </TextBlock>
                                
                                <TextBlock FontSize="11" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap">
                                    <Run Text="Tip: You can also manually create a restore point using the button below if you want extra safety."/>
                                </TextBlock>
                                
                                <Button Content="Create Manual Restore Point" 
                                        Style="{StaticResource SecondaryButton}"
                                        Command="{Binding CreateRestorePointCommand}"
                                        HorizontalAlignment="Left" Padding="16,8" Margin="0,12,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Execute Cleanup -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="{Binding CleanupStatusText}" 
                                           FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center"/>
                                <!-- Progress indicator during cleanup -->
                                <ProgressBar IsIndeterminate="True" 
                                             Height="4" 
                                             Margin="0,8,24,0"
                                             Background="#1AFFFFFF"
                                             Foreground="#FF9800"
                                             Visibility="{Binding CleanupInProgress, Converter={StaticResource BoolToVisibility}}"/>
                            </StackPanel>
                            
                            <Button Grid.Column="1" 
                                    Content="ðŸ—‘ï¸ Run Cleanup" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding RunCleanupCommand}"
                                    Padding="16,8"
                                    Background="OrangeRed"/>
                        </Grid>
                        
                        <!-- Cleanup Steps Log (visible during/after cleanup) -->
                        <Border Background="#0AFFFFFF" 
                                CornerRadius="6" 
                                Padding="12" 
                                Margin="0,12,0,0"
                                MaxHeight="200"
                                Visibility="{Binding HasCleanupSteps, Converter={StaticResource BoolToVisibility}}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <ItemsControl ItemsSource="{Binding OmenCleanupSteps}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" 
                                                       FontSize="11" 
                                                       FontFamily="Consolas"
                                                       Foreground="{StaticResource TextSecondaryBrush}"
                                                       Margin="0,2"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Border>
                        
                        <!-- Restart prompt after cleanup -->
                        <Border Background="#1A2196F3" 
                                CornerRadius="6" 
                                Padding="12" 
                                Margin="0,12,0,0"
                                Visibility="{Binding CleanupComplete, Converter={StaticResource BoolToVisibility}}">
                            <StackPanel>
                                <TextBlock Text="ðŸ’¡ Restart recommended to complete cleanup" 
                                           FontSize="12" FontWeight="SemiBold"
                                           Foreground="#2196F3"/>
                                <TextBlock Text="Some components may still be running until you restart Windows." 
                                           FontSize="11" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Profile Management -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M12,15.39L8.24,17.66L9.23,13.38L5.91,10.5L10.29,10.13L12,6.09L13.71,10.13L18.09,10.5L14.77,13.38L15.76,17.66M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z" 
                                  Fill="#64B5F6" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Profile Management" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Save and load your complete OmenCore configuration" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Profile buttons -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="ðŸ“¥ Import Profile" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding ImportProfileCommand}"
                                    Padding="16,8" Margin="0,0,12,0"
                                    ToolTip="Load fan curves, performance modes, and GPU OC settings from .omencore file"/>
                            <Button Content="ðŸ“¤ Export Profile" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding ExportProfileCommand}"
                                    Padding="16,8" Margin="0,0,12,0"
                                    ToolTip="Save your current configuration to share or backup"/>
                            <Button Content="ðŸ”¬ Export Diagnostics" 
                                    Style="{StaticResource SecondaryButton}"
                                    Command="{Binding ExportDiagnosticsCommand}"
                                    Padding="16,8"
                                    ToolTip="Export logs and system info for troubleshooting"/>
                        </StackPanel>

                        <!-- Info -->
                        <Border Background="#1A64B5F6" CornerRadius="4" Padding="12">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}">
                                <Run FontWeight="SemiBold" Foreground="#64B5F6">ðŸ’¡ Profile Info:</Run>
                                <LineBreak/>
                                â€¢ Profiles include fan curves, performance modes, GPU OC settings, battery/hysteresis config
                                <LineBreak/>
                                â€¢ Safe to share - no personal data included, just hardware settings
                                <LineBreak/>
                                â€¢ Diagnostics export creates a troubleshooting bundle (logs, config, hardware status)
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Data & Storage -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z" 
                                  Fill="#CE93D8" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Data &amp; Storage" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="ðŸ“‚ Open Config Folder" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenConfigFolderCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ“‹ Open Log Folder" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenLogFolderCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ”„ Reset to Defaults" 
                                    Style="{StaticResource SecondaryButton}"
                                    Command="{Binding ResetToDefaultsCommand}"
                                    Padding="16,8"
                                    ToolTip="Reset all settings to default values"/>
                        </StackPanel>

                        <TextBlock Text="{Binding ConfigFolderPath}" 
                                   FontSize="11" 
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="About">
                <ScrollViewer Style="{StaticResource SmoothScrollViewer}" Padding="0,0,12,0">
                    <StackPanel Margin="20,20,20,40">

                <!-- About Section -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconAbout}" 
                                  Fill="{StaticResource AccentBrush}" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="About OmenCore" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <TextBlock FontSize="14" Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,4">
                            <Run Text="Version: "/><Run Text="{Binding AppVersion, Mode=OneWay}" FontWeight="SemiBold"/>
                        </TextBlock>
                        <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,16">
                            A lightweight replacement for HP OMEN Gaming Hub
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸŒ GitHub" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenGitHubCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ“ Release Notes" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenReleaseNotesCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ› Report Issue" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenIssuesCommand}"
                                    Padding="16,8"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        
        <!-- Loading Overlay -->
        <controls:LoadingOverlay Grid.RowSpan="2" Panel.ZIndex="1000" />
    </Grid>
</UserControl>
