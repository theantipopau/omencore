<UserControl x:Class="OmenCore.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:OmenCore.Controls"
             xmlns:utils="clr-namespace:OmenCore.Utils"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1000">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Settings" 
                   FontSize="28" FontWeight="Bold" 
                   Foreground="{StaticResource TextPrimaryBrush}" 
                   Margin="0,0,0,16"/>

        <ScrollViewer Grid.Row="1" Style="{StaticResource SmoothScrollViewer}" utils:ScrollSpeedBehavior.ScrollSpeedMultiplier="1.2">
            <StackPanel>
                <!-- System Status Section -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconMonitoring}" 
                                  Fill="#4CAF50" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="System Status" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>
                        
                        <!-- Backend Status -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan Control Backend" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="The method used to control fans on your system" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <Border Grid.Column="1" Background="#1A4CAF50" CornerRadius="4" Padding="12,6">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#4CAF50" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding FanBackend, FallbackValue=Detecting...}" 
                                               FontSize="13" FontWeight="SemiBold"
                                               Foreground="#4CAF50"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                        
                        <!-- Secure Boot Status -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Secure Boot" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Secure Boot is disabled - WinRing0 driver available"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                    <Setter Property="Text" Value="Secure Boot blocks unsigned drivers. Use PawnIO or WMI BIOS."/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1A4CAF50"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                <Setter Property="Background" Value="#1AFF9800"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Disabled"/>
                                            <Setter Property="Foreground" Value="#4CAF50"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SecureBootEnabled}" Value="True">
                                                    <Setter Property="Text" Value="ðŸ”’ Enabled"/>
                                                    <Setter Property="Foreground" Value="#FF9800"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                        
                        <!-- PawnIO Status -->
                        <Grid Margin="0,0,0,12" Visibility="{Binding SecureBootEnabled, Converter={StaticResource BoolToVisibility}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="PawnIO Driver" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Secure Boot compatible driver for EC/MSR access" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1AF44336"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding PawnIOAvailable}" Value="True">
                                                <Setter Property="Background" Value="#1A4CAF50"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Not Installed"/>
                                            <Setter Property="Foreground" Value="#F44336"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding PawnIOAvailable}" Value="True">
                                                    <Setter Property="Text" Value="âœ“ Installed"/>
                                                    <Setter Property="Foreground" Value="#4CAF50"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                        
                        <!-- OGH Status -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="OMEN Gaming Hub" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="HP's official control software - provides WMI access" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <Border Grid.Column="1" CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#1A808080"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding OghInstalled}" Value="True">
                                                <Setter Property="Background" Value="#1A4CAF50"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="Not Installed"/>
                                            <Setter Property="Foreground" Value="#808080"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding OghInstalled}" Value="True">
                                                    <Setter Property="Text" Value="âœ“ Installed"/>
                                                    <Setter Property="Foreground" Value="#4CAF50"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- General Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconSettings}" 
                                  Fill="{StaticResource AccentBrush}" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="General" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Start with Windows -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Start with Windows" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Launch OmenCore automatically when Windows starts" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding StartWithWindows}"/>
                        </Grid>

                        <!-- Start Minimized -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Start minimized to tray" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Hide main window on startup, show only in system tray" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding StartMinimized}"/>
                        </Grid>

                        <!-- Minimize to Tray on Close -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Minimize to tray on close" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Close button minimizes to system tray instead of exiting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding MinimizeToTrayOnClose}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Monitoring Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconMonitoring}" 
                                  Fill="#4FC3F7" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Monitoring" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Polling Interval -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Polling interval" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="How often to read hardware sensors" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Slider Minimum="500" Maximum="5000" 
                                        TickFrequency="250"
                                        IsSnapToTickEnabled="True"
                                        Value="{Binding PollingIntervalMs}"
                                        Width="120" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding PollingIntervalMs, StringFormat={}{0} ms}" 
                                           FontSize="12" Width="60" TextAlignment="Right"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- History Length -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Chart history" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Number of data points to display in charts" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Slider Minimum="30" Maximum="300" 
                                        TickFrequency="30"
                                        IsSnapToTickEnabled="True"
                                        Value="{Binding HistoryCount}"
                                        Width="120" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding HistoryCount, StringFormat={}{0} points}" 
                                           FontSize="12" Width="60" TextAlignment="Right"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Grid>

                        <!-- Low Overhead Mode -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Low overhead mode" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Reduce CPU usage by limiting sensor polling" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding LowOverheadMode}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Power Automation Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M12 3C10.3 3 9 4.3 9 6V8H15V6C15 4.3 13.7 3 12 3M7 8V6C7 3.2 9.2 1 12 1S17 3.2 17 6V8H18C19.1 8 20 8.9 20 10V20C20 21.1 19.1 22 18 22H6C4.9 22 4 21.1 4 20V10C4 8.9 4.9 8 6 8H7M13 15V17H11V15H9V13H11V11H13V13H15V15H13Z" 
                                  Fill="#FFB74D" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Power Automation" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Power Automation -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Auto-switch on power change" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Automatically switch profiles when AC power is connected or disconnected" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding PowerAutomationEnabled, Mode=TwoWay}"/>
                        </Grid>

                        <!-- AC Power Settings -->
                        <TextBlock Text="When on AC Power:" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan preset" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding AcFanPreset, Mode=TwoWay}"
                                      ItemsSource="{Binding FanPresetOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Performance mode" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding AcPerformanceMode, Mode=TwoWay}"
                                      ItemsSource="{Binding PerformanceModeOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>

                        <!-- Battery Settings -->
                        <TextBlock Text="When on Battery:" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,8,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fan preset" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding BatteryFanPreset, Mode=TwoWay}"
                                      ItemsSource="{Binding FanPresetOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="150"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Performance mode" FontSize="13" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" SelectedItem="{Binding BatteryPerformanceMode, Mode=TwoWay}"
                                      ItemsSource="{Binding PerformanceModeOptions}"
                                      IsEnabled="{Binding PowerAutomationEnabled}"/>
                        </Grid>

                        <!-- Current Power Status -->
                        <Border Background="#1F1F1F" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Current status: " FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding CurrentPowerStatus}" FontSize="12" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Updates Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconUpdate}" 
                                  Fill="#81C784" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Updates" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Auto Check Updates -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Check for updates automatically" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Periodically check GitHub for new releases" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding AutoCheckUpdates}"/>
                        </Grid>

                        <!-- Update Check Interval -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Check interval" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="How often to check for updates" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource ModernComboBox}"
                                      SelectedIndex="{Binding UpdateCheckIntervalIndex}"
                                      HorizontalAlignment="Right" Width="150">
                                <ComboBoxItem Content="Every hour"/>
                                <ComboBoxItem Content="Every 6 hours"/>
                                <ComboBoxItem Content="Daily"/>
                                <ComboBoxItem Content="Weekly"/>
                            </ComboBox>
                        </Grid>

                        <!-- Include Pre-releases -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Include pre-releases" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Get notified about beta and preview versions" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding IncludePreReleases}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Hotkeys Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="âŒ¨ï¸" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Hotkeys" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Hotkeys -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable global hotkeys" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Use keyboard shortcuts even when app is in background" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding HotkeysEnabled}"/>
                        </Grid>

                        <!-- Hotkey Reference -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="16" Margin="0,8,0,0">
                            <StackPanel>
                                <TextBlock Text="Default Hotkeys" FontSize="14" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Ctrl + Shift + F" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Cycle fan modes" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Ctrl + Shift + P" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="Cycle performance modes" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ctrl + Shift + B" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="Boost mode (Performance)" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Ctrl + Shift + Q" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="Quiet mode" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Ctrl + Shift + O" FontFamily="Consolas" 
                                               Foreground="{StaticResource AccentBrush}" FontSize="12" Margin="0,4,0,0"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" Text="Show/hide OmenCore window" 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" Margin="0,4,0,0"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Notifications Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ””" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Notifications" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Enable Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Show Windows toast notifications for events" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Game Profile Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Game profile notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Notify when game profiles are activated/deactivated" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GameNotificationsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Mode Change Notifications -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Mode change notifications" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Notify when fan or performance modes change via hotkey" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding ModeChangeNotificationsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>

                        <!-- Temperature Warning Notifications -->
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Temperature warnings" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Alert when CPU/GPU temperature exceeds threshold" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding TemperatureWarningsEnabled}"
                                          IsEnabled="{Binding NotificationsEnabled}"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Driver Installation -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconSettings}" 
                                  Fill="#9575CD" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Hardware Driver" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- Driver Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Ellipse Grid.Column="0" 
                                         Width="12" Height="12" 
                                         Fill="{Binding DriverStatusColor}"
                                         VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding DriverStatusText}" 
                                               FontSize="14" FontWeight="SemiBold"
                                               Foreground="{StaticResource TextPrimaryBrush}"/>
                                    <TextBlock Text="{Binding DriverStatusDetail}" 
                                               FontSize="12" 
                                               Foreground="{StaticResource TextSecondaryBrush}"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <TextBlock TextWrapping="Wrap" FontSize="13" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            On modern Windows systems, Secure Boot and Memory Integrity can block legacy drivers.
                            OmenCore prefers driverless control paths (WMI/OGH) when available, and recommends PawnIO for Secure Boot compatible EC access.
                            WinRing0 is a legacy fallback for certain features.
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ“¥ Get Driver Backend (PawnIO / LibreHardwareMonitor)" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#9575CD"
                                    Command="{Binding InstallDriverCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"
                                    Margin="0,0,12,0"/>
                            <Button Content="ðŸ”„ Refresh Status" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding RefreshDriverStatusCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- BIOS Update Check -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M9,2V7H12V10H9A3,3 0 0,0 6,13V15A3,3 0 0,0 9,18H12V22H14V18H15A3,3 0 0,0 18,15V13A3,3 0 0,0 15,10H14V7H17V2H15V5H12V2H9M9,12H15A1,1 0 0,1 16,13V15A1,1 0 0,1 15,16H9A1,1 0 0,1 8,15V13A1,1 0 0,1 9,12Z" 
                                  Fill="#4DD0E1" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="BIOS Information" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- System Model -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="HP Model:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding SystemModel}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </Grid>

                        <!-- Current BIOS -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Current BIOS:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding CurrentBiosVersion}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </Grid>

                        <!-- Latest BIOS (only show when we have a version) -->
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Latest BIOS:" FontSize="13" 
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                            <TextBlock Grid.Column="1" Text="{Binding LatestBiosVersion}" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        </Grid>

                        <!-- BIOS Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,8,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Ellipse Grid.Column="0" 
                                         Width="12" Height="12" 
                                         Fill="{Binding BiosStatusColor}"
                                         VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" Text="{Binding BiosCheckStatus}" 
                                           FontSize="13" 
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <TextBlock TextWrapping="Wrap" FontSize="12" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            Check HP's website for BIOS updates. Always read the release notes before updating BIOS.
                            BIOS updates can improve stability, security, and compatibility.
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸ” Check for Updates" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#4DD0E1"
                                    Command="{Binding CheckBiosUpdatesCommand}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"
                                    Margin="0,0,12,0"/>
                            <Button Content="â¬‡ï¸ Download Update" 
                                    Style="{StaticResource ModernButton}"
                                    Background="#66BB6A"
                                    Command="{Binding DownloadBiosUpdateCommand}"
                                    Visibility="{Binding BiosUpdateAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    HorizontalAlignment="Left"
                                    Padding="20,10"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Fan Boost / Maintenance -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconFan}" 
                                  Fill="#FFB74D" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Fan Boost" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <TextBlock TextWrapping="Wrap" FontSize="13" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   Margin="0,0,0,12">
                            Runs fans at maximum speed to increase airflow and help dislodge loose dust particles.
                        </TextBlock>
                        
                        <!-- Important disclaimer -->
                        <Border Background="#33FFB74D" CornerRadius="6" Padding="12" Margin="0,0,0,16">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextPrimaryBrush}">
                                <Run Foreground="#FFB74D" FontWeight="Bold">âš ï¸ Note:</Run>
                                This is NOT the same as HP's "Fan Cleaner" feature (OMEN Max only) which actually reverses fan direction.
                                That requires special omnidirectional fans that most OMEN laptops don't have.
                                <LineBreak/><LineBreak/>
                                For thorough cleaning, use compressed air or open the chassis.
                            </TextBlock>
                        </Border>

                        <!-- HP OMEN Detection Status -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="12" Margin="0,0,0,16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Grid.Column="0" 
                                      Data="{Binding FanCleaningStatusIcon}" 
                                      Fill="{Binding FanCleaningStatusColor}" 
                                      Width="20" Height="20" Stretch="Uniform" 
                                      VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" 
                                           Text="{Binding FanCleaningStatusText}" 
                                           FontSize="13" 
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </Border>

                        <Button Content="ðŸ’¨ Start Fan Boost" 
                                Style="{StaticResource ModernButton}"
                                Background="#FFB74D"
                                Command="{Binding StartFanCleaningCommand}"
                                IsEnabled="{Binding CanStartFanCleaning}"
                                HorizontalAlignment="Left"
                                Padding="20,10"/>

                        <!-- Boost Progress -->
                        <StackPanel Visibility="{Binding IsFanCleaningActive, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    Margin="0,16,0,0">
                            <TextBlock Text="{Binding FanCleaningProgress}" 
                                       FontSize="14" 
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       Margin="0,0,0,8"/>
                            <ProgressBar Value="{Binding FanCleaningProgressPercent}" 
                                         Maximum="100" Height="8"
                                         Foreground="#FFB74D"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Feature Toggles -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ§©" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Feature Modules" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Enable/disable features to reduce resource usage" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Corsair Integration -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Corsair iCUE Integration" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Support for Corsair keyboards, mice, headsets" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding CorsairIntegrationEnabled}"/>
                        </Grid>

                        <!-- Logitech Integration -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Logitech G HUB Integration" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Support for Logitech G peripherals" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding LogitechIntegrationEnabled}"/>
                        </Grid>

                        <!-- Game Profiles -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Game Profile Auto-Switching" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Automatically apply profiles when games launch" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GameProfilesEnabled}"/>
                        </Grid>

                        <!-- Keyboard Lighting -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Keyboard Backlight Control" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="OMEN keyboard 4-zone RGB lighting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding KeyboardLightingEnabled}"/>
                        </Grid>

                        <!-- Fan Curves -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Custom Fan Curves" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Continuous fan speed adjustment (disable for BIOS-only control)" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FanCurvesEnabled}"/>
                        </Grid>

                        <!-- Power Automation -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Power Source Automation" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Auto-switch profiles when plugging/unplugging AC" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FeaturePowerAutomationEnabled}"/>
                        </Grid>

                        <!-- GPU Switching -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="GPU Mode Switching" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Control Hybrid/Discrete/Optimus modes" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding GpuSwitchingEnabled}"/>
                        </Grid>

                        <!-- Undervolt -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="CPU Undervolt Controls" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Voltage offset adjustment (requires compatible CPU)" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding UndervoltEnabled}"/>
                        </Grid>

                        <!-- OMEN Key Section -->
                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" Margin="0,8,0,0">
                            <StackPanel>
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸŽ®" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="OMEN Key Interception" FontSize="14" FontWeight="SemiBold"
                                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                                        </StackPanel>
                                        <TextBlock Text="Capture OMEN key to show OmenCore instead of HP Gaming Hub" FontSize="12" 
                                                   Foreground="{StaticResource TextSecondaryBrush}" Margin="24,4,0,0"/>
                                    </StackPanel>
                                    <ToggleButton Grid.Column="1" 
                                                  Style="{StaticResource ModernToggleButton}"
                                                  IsChecked="{Binding OmenKeyInterceptionEnabled}"/>
                                </Grid>
                                
                                <Grid Margin="0,0,0,0" IsEnabled="{Binding OmenKeyInterceptionEnabled}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="OMEN Key Action" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                    <ComboBox Grid.Column="1" 
                                              SelectedItem="{Binding OmenKeyAction, Mode=TwoWay}"
                                              ItemsSource="{Binding OmenKeyActionOptions}"
                                              IsEnabled="{Binding OmenKeyInterceptionEnabled}"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Note -->
                        <Border Background="#1F1F1F" CornerRadius="4" Padding="12" Margin="0,16,0,0">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}">
                                <Run FontWeight="SemiBold" Foreground="{StaticResource TextPrimaryBrush}">ðŸ’¡ Tip:</Run>
                                Disable unused features to reduce CPU/memory usage. Restart OmenCore for changes to take effect.
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- In-Game OSD Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ“Š" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="In-Game OSD" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="On-screen overlay showing system stats during gaming" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Master Enable -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable OSD Overlay" FontSize="14" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="When disabled, no OSD background process runs at all" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding OsdEnabled}"/>
                        </Grid>

                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" 
                                IsEnabled="{Binding OsdEnabled}">
                            <StackPanel>
                                <!-- Position -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Position" FontSize="13" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1" 
                                              SelectedItem="{Binding OsdPosition, Mode=TwoWay}"
                                              ItemsSource="{Binding OsdPositionOptions}"/>
                                </Grid>

                                <!-- Hotkey -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="150"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Toggle Hotkey" FontSize="13" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Text="{Binding OsdHotkey, Mode=TwoWay}" 
                                             Padding="8,6"/>
                                </Grid>

                                <!-- Metrics Selection -->
                                <TextBlock Text="Metrics to Display" FontSize="13" FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,4,0,8"/>
                                <WrapPanel>
                                    <CheckBox Content="CPU Temp" IsChecked="{Binding OsdShowCpuTemp}" Margin="0,0,16,8"/>
                                    <CheckBox Content="GPU Temp" IsChecked="{Binding OsdShowGpuTemp}" Margin="0,0,16,8"/>
                                    <CheckBox Content="CPU Load" IsChecked="{Binding OsdShowCpuLoad}" Margin="0,0,16,8"/>
                                    <CheckBox Content="GPU Load" IsChecked="{Binding OsdShowGpuLoad}" Margin="0,0,16,8"/>
                                    <CheckBox Content="Fan Speed" IsChecked="{Binding OsdShowFanSpeed}" Margin="0,0,16,8"/>
                                    <CheckBox Content="RAM Usage" IsChecked="{Binding OsdShowRamUsage}" Margin="0,0,16,8"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Battery Care Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ”‹" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Battery Care" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Extend battery lifespan with charge limiting" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Charge Limit -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Limit Charge to 80%" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Preserves battery health by stopping charge at 80%" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding BatteryChargeLimitEnabled}"/>
                        </Grid>

                        <Border Background="#1A4CAF50" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <TextBlock TextWrapping="Wrap" FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}">
                                <Run FontWeight="SemiBold" Foreground="#81C784">ðŸ’¡ Battery Health:</Run>
                                Limiting charge to 80% can extend your battery's lifespan by 2-4x.
                                This is especially useful if your laptop is usually plugged in.
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Fan Hysteresis Settings -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸŒ€" FontSize="24" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <StackPanel>
                                <TextBlock Text="Fan Hysteresis" FontSize="20" FontWeight="SemiBold" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Prevent fan speed oscillation with dead-zone and delays" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Enable -->
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Enable Hysteresis" FontSize="14" 
                                           Foreground="{StaticResource TextPrimaryBrush}"/>
                                <TextBlock Text="Smooth out fan speed changes to reduce noise fluctuation" FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            <ToggleButton Grid.Column="1" 
                                          Style="{StaticResource ModernToggleButton}"
                                          IsChecked="{Binding FanHysteresisEnabled}"/>
                        </Grid>

                        <Border Background="#1A6B4C9A" CornerRadius="8" Padding="16" 
                                IsEnabled="{Binding FanHysteresisEnabled}">
                            <StackPanel>
                                <!-- Dead Zone -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Temperature Dead-Zone" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Fans won't change unless temp moves beyond this" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisDeadZone, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="Â°C" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Ramp Up Delay -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Ramp-Up Delay" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Wait before increasing fan speed" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisRampUpDelay, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="s" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Ramp Down Delay -->
                                <Grid Margin="0,0,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Ramp-Down Delay" FontSize="13" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                        <TextBlock Text="Wait before decreasing fan speed" FontSize="11" 
                                                   Foreground="{StaticResource TextTertiaryBrush}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBox Text="{Binding FanHysteresisRampDownDelay, StringFormat=F1}" 
                                                 Width="50" Padding="6,4" TextAlignment="Right"/>
                                        <TextBlock Text="s" VerticalAlignment="Center" Margin="4,0,0,0" 
                                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- HP Omen Gaming Hub Cleanup (only show when OGH is installed) -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16"
                        Visibility="{Binding OghInstalled, Converter={StaticResource BoolToVisibility}}">
                    <StackPanel DataContext="{Binding DataContext.SystemControl, RelativeSource={RelativeSource AncestorType=Window}}">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" 
                                  Fill="OrangeRed" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="HP OMEN Gaming Hub Cleanup" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>
                        
                        <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0,0,0,8" TextWrapping="Wrap">
                            <Run Text="Remove HP OMEN Gaming Hub and related services. This is optional and will free up system resources."/>
                        </TextBlock>
                        
                        <TextBlock FontSize="12" Margin="0,0,0,16" TextWrapping="Wrap">
                            <Run Text="âš ï¸ Warning: These operations cannot be undone easily. Create a System Restore Point before proceeding." FontWeight="Bold" Foreground="Orange"/>
                        </TextBlock>

                        <!-- Cleanup Options -->
                        <StackPanel Margin="0,0,0,16">
                            <CheckBox Content="Kill running HP OMEN processes" 
                                      IsChecked="{Binding CleanupKillProcesses}"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      Margin="0,0,0,8"/>
                            
                            <CheckBox Content="Uninstall HP OMEN Gaming Hub application" 
                                      IsChecked="{Binding CleanupUninstallApp}"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      Margin="0,0,0,8"/>
                            
                            <CheckBox Content="Remove HP OMEN services (OmenService, LightingService)" 
                                      IsChecked="{Binding CleanupRemoveServices}"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      Margin="0,0,0,8"/>
                            
                            <CheckBox Content="Clean HP OMEN registry entries" 
                                      IsChecked="{Binding CleanupRegistryEntries}"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      Margin="0,0,0,8"/>
                            
                            <CheckBox Content="Remove HP OMEN legacy installers (winget/AppX)" 
                                      IsChecked="{Binding CleanupRemoveLegacyInstallers}"
                                      Foreground="{StaticResource TextPrimaryBrush}"
                                      Margin="0,0,0,8"/>
                            
                            <CheckBox Content="Remove residual HP OMEN files and folders" 
                                      IsChecked="{Binding CleanupRemoveFiles}"
                                      Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- System Restore -->
                        <Border Background="{StaticResource SurfaceDarkBrush}" 
                                CornerRadius="8" Padding="16" Margin="0,0,0,16"
                                BorderBrush="Orange" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="âš ï¸ Create System Restore Point" 
                                           FontSize="14" FontWeight="SemiBold"
                                           Foreground="Orange" Margin="0,0,0,8"/>
                                
                                <TextBlock Text="Highly recommended before performing cleanup operations." 
                                           FontSize="12" 
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap" Margin="0,0,0,8"/>
                                
                                <Button Content="Create Restore Point" 
                                        Style="{StaticResource ModernButton}"
                                        Command="{Binding CreateRestorePointCommand}"
                                        HorizontalAlignment="Left" Padding="16,8"/>
                            </StackPanel>
                        </Border>

                        <!-- Execute Cleanup -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" 
                                       Text="{Binding CleanupStatusText}" 
                                       FontSize="12" 
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       VerticalAlignment="Center"/>
                            
                            <Button Grid.Column="1" 
                                    Content="ðŸ—‘ï¸ Run Cleanup" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding RunCleanupCommand}"
                                    Padding="16,8"
                                    Background="OrangeRed"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Data & Storage -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z" 
                                  Fill="#CE93D8" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="Data &amp; Storage" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="ðŸ“‚ Open Config Folder" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenConfigFolderCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ“‹ Open Log Folder" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenLogFolderCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ”„ Reset to Defaults" 
                                    Style="{StaticResource SecondaryButton}"
                                    Command="{Binding ResetToDefaultsCommand}"
                                    Padding="16,8"
                                    ToolTip="Reset all settings to default values"/>
                        </StackPanel>

                        <TextBlock Text="{Binding ConfigFolderPath}" 
                                   FontSize="11" 
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- About Section -->
                <Border Style="{StaticResource SurfaceCard}" Padding="24">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <Path Data="{StaticResource IconAbout}" 
                                  Fill="{StaticResource AccentBrush}" 
                                  Width="24" Height="24" Stretch="Uniform" 
                                  VerticalAlignment="Center" Margin="0,0,12,0"/>
                            <TextBlock Text="About OmenCore" FontSize="20" FontWeight="SemiBold" 
                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <TextBlock FontSize="14" Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,4">
                            <Run Text="Version: "/><Run Text="{Binding AppVersion, Mode=OneWay}" FontWeight="SemiBold"/>
                        </TextBlock>
                        <TextBlock FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,16">
                            A lightweight replacement for HP OMEN Gaming Hub
                        </TextBlock>

                        <StackPanel Orientation="Horizontal">
                            <Button Content="ðŸŒ GitHub" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenGitHubCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ“ Release Notes" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenReleaseNotesCommand}"
                                    Padding="16,8" Margin="0,0,12,0"/>
                            <Button Content="ðŸ› Report Issue" 
                                    Style="{StaticResource ModernButton}"
                                    Command="{Binding OpenIssuesCommand}"
                                    Padding="16,8"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- Loading Overlay -->
        <controls:LoadingOverlay Grid.RowSpan="2" Panel.ZIndex="1000" />
    </Grid>
</UserControl>
